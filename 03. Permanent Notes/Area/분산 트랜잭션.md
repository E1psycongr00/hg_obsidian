---
tags:
  - 분산시스템
aliases: null
created: 2024-12-18T00:00:00.000Z
title: 분산 트랜잭션
note-type: COMMON
completed: true
---

## 내용(Content)

### 분산 트랜잭션

분산 트랜잭션은 **여러 독립적인 시스템이나 데이터베이스에 걸쳐 있는 작업들을 하나의 트랜잭션으로 관리**하는 것을 의미한다. 이는 [[03. Permanent Notes/Area/DB 트랜잭션#트랜잭션의 특징(ACID)|트랜잭션의 ACID 특성]]을 분산 환경에서도 보장하기 위한 메커니즘이다.

### 분산 트랜잭션이 필요한 이유

1. **일관성 보장**
    - 분산 환경에서 데이터가 여러 시스템에 분산되어 있을 경우, 각각의 시스템이 동일한 상태를 유지해야 한다. 분산 트랜잭션은 이를 보장한다.

2. **업무 프로세스 통합**
    - 전자 상거래나 은행 시스템처럼 여러 서비스나 데이터베이스가 함께 작동해야 하는 상황에서, 트랜잭션이 성공적으로 완료되도록 조율이 필요하다.
        
3. **에러 복구**
    - 네트워크 오류나 시스템 장애 발생 시 데이터 무결성을 유지하고 일관성을 복구하기 위해 분산 트랜잭션이 필요하다.

4. **비즈니스 요구사항**
    - 다양한 분산 시스템에서 이루어지는 복잡한 업무 로직이 트랜잭션 내에서 안전하게 수행되도록 하기 위한 요구가 증가하고 있다.

### 분산 트랜잭션의 예

1. **전자 상거래 시스템**
    
    - 주문 생성, 결제, 재고 차감 작업이 각각 다른 서비스에 의해 처리되는 경우.
    - 모든 작업이 성공해야만 트랜잭션이 완료된다.
        
2. **은행 시스템**
    
    - 두 계좌 간 이체 작업이 다른 데이터베이스에 걸쳐 있을 때.
    - 한 계좌의 출금과 다른 계좌의 입금 작업이 모두 성공해야 한다.

### 분산 트랜잭션 프로토콜

#### 1. 2-Phase Commit (2PC)

- 분산 트랜잭션에서 가장 널리 사용되는 프로토콜이다.
- 두 단계로 구성된다:
    1. **Prepare Phase (준비 단계):**  
        각 참여 노드는 트랜잭션을 준비하고 성공 여부를 트랜잭션 관리자에게 응답한다.
    2. **Commit Phase (커밋 단계):**  
        모든 노드가 성공 응답을 보내면 커밋을 진행하고, 실패 응답이 있으면 롤백한다.
- 단점: 네트워크 지연이나 노드 장애 시 블로킹 문제가 발생할 수 있다.
    

#### 2. 3-Phase Commit (3PC)

- 2PC의 블로킹 문제를 완화하기 위해 설계된 프로토콜이다.
- **Prepare, Pre-Commit, Commit** 단계로 나뉜다.
- 각 단계에서 타임아웃을 설정하여 시스템 장애에 대한 복구를 돕는다.


### 분산 트랜잭션의 장단점

#### 장점

1. **데이터 일관성 보장**
    - 분산 환경에서도 데이터의 무결성과 일관성을 유지할 수 있다.

2. **확장성**
    - 분산 시스템을 활용하여 대규모 트랜잭션 처리 가능.
        

#### 단점

1. **복잡성 증가**
    - 네트워크, 동기화, 실패 복구 등 추가적인 관리가 필요하다.

2. **성능 문제**
    - 트랜잭션 조율로 인해 처리 속도가 느려질 수 있다.
        
3. **블로킹 위험**
    - 2PC와 같은 프로토콜에서 장애가 발생하면 시스템이 정지할 위험이 있다.

## 질문 & 확장

1. 2PC와 3PC의 주요 차이점은 무엇인가?
2. 사가 패턴을 사용하면 분산 트랜잭션의 성능 문제를 얼마나 개선할 수 있는가?
3. 분산 트랜잭션에서 네트워크 장애 발생 시 복구 전략은 무엇인가?

## 출처(링크)

- "Distributed Systems: Principles and Paradigms" by Andrew S. Tanenbaum
- "Designing Data-Intensive Applications" by Martin Kleppmann

## 연결 노트
down:: [[03. Permanent Notes/Area/분산 시스템 합의 알고리즘]]
example:: [[03. Permanent Notes/Area/2 Phase Commit]]
example:: [[03. Permanent Notes/Area/3 Phase Commit]]








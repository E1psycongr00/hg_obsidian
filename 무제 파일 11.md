## 내용

### 주제 요약
SAGA 패턴은 마이크로서비스 환경에서 분산 트랜잭션을 관리하기 위한 방법으로, 각각의 로컬 트랜잭션과 그에 대응하는 보상 트랜잭션으로 구성된다[^1]. 이는 장시간 실행되는 비즈니스 트랜잭션을 처리할 때 데이터 일관성을 유지하는데 사용된다.

### 핵심 구성 요소

1. **로컬 트랜잭션 (Local Transactions)**
   - 각 서비스의 독립적인 트랜잭션을 관리한다[^2].
   - 트랜잭션은 순차적으로 실행된다.
   - 예시:
     ```java
     public class OrderSaga {
         @Transactional
         public void createOrder() {
             // 주문 생성
             orderService.create();
             // 결제 처리
             paymentService.process();
             // 배송 요청
             deliveryService.request();
         }
     }
     ```

2. **보상 트랜잭션 (Compensating Transactions)**
   - 실패 시 이전 트랜잭션을 취소한다[^3].
   - 역순으로 실행된다.
   - 멱등성을 보장해야 한다.

### 구현 방식

1. **Choreography-based SAGA**
   - 각 서비스가 이벤트를 발행하고 구독한다.
   - 중앙 조정자가 없다.
   - 느슨한 결합을 제공한다.

2. **Orchestration-based SAGA**
   - 중앙 조정자가 트랜잭션을 관리한다[^4].
   - 명확한 트랜잭션 흐름 제어가 가능하다.
   - 복잡성이 중앙화된다.

### 장단점

**장점:**
- 서비스 간 강한 결합 방지
- 장애 복구 메커니즘 제공
- 확장성과 가용성 향상

**단점:**
- 구현 복잡도 증가
- 일시적 데이터 불일치 가능성
- 디버깅과 테스트의 어려움

## 질문 & 확장

1. SAGA 패턴이 적합하지 않은 비즈니스 시나리오는 어떤 것들이 있는가?
2. 보상 트랜잭션이 실패하는 경우 어떻게 대처해야 하는가?
3. SAGA 패턴과 2PC(Two-Phase Commit)의 차이점과 각각의 사용 시나리오는?
4. 이벤트 소싱(Event Sourcing)과 SAGA 패턴을 함께 사용할 때의 이점은?

## 출처

[^1]: Garcia-Molina, H., & Salem, K. (1987). "SAGAS"
    > "A SAGA is a long-lived transaction that can be written as a sequence of transactions that can be interleaved with other transactions."
    
    SAGA 패턴의 기본 개념과 이론적 기초를 제공하는 원본 논문이다.

[^2]: Richardson, C. (2018). "Microservices Patterns"
    > "Each local transaction is atomic and preserves the database consistency within its bounded context."
    
    마이크로서비스 환경에서의 SAGA 패턴 구현에 대한 실용적 가이드를 제공한다.

[^3]: Newman, S. (2015). "Building Microservices"
    > "Compensating transactions are used to undo the changes made by the local transactions in case of failures."
    
    보상 트랜잭션의 개념과 중요성을 설명하는데 참조되었다.

[^4]: Kleppmann, M. (2017). "Designing Data-Intensive Applications"
    > "Orchestration allows centralized coordination of distributed transactions, making it easier to track and manage the overall transaction flow."
    
    SAGA 구현 방식과 트레이드오프를 이해하는데 도움을 주는 자료이다.
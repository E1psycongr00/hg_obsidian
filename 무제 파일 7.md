---
mindmap-plugin: basic
---
# 📜 **Python 코드 리팩토링 강제 지침**

## 🎯 **지침 개요**
아래 지침을 **반드시** 준수하여 코드를 리팩토링하세요.  
조건을 위반할 경우, 이를 식별하고 수정 방안을 함께 제공합니다.

---

## 🛠 **리팩토링 지침**

### 1. 함수 및 메서드 분리
- 모든 함수와 메서드는 **10줄 이하**로 작성해야 합니다.
- 각 함수는 **하나의 작업만** 수행해야 합니다.

#### ✅ 예시
**리팩토링 전:**
```python
def process_data(data):
    processed = []
    for item in data:
        if item > 0:
            processed.append(item * 2)
    return sum(processed)
```

**리팩토링 후:**
```python
def filter_positive(data):
    """Filter positive numbers from the data."""
    return [item for item in data if item > 0]

def double_items(items):
    """Double each item in the list."""
    return [item * 2 for item in items]

def process_data(data):
    """Process the data by filtering, doubling, and summing."""
    filtered = filter_positive(data)
    doubled = double_items(filtered)
    return sum(doubled)
```

---

### 2. 조건문 사용 규칙
- 중첩된 `if` 문은 **사용하지 않습니다**. 모든 조건문은 평탄화(flatten)해야 합니다.
- `else` 문은 **사용하지 않습니다**. 대신 조건문을 재구성합니다.

#### ✅ 예시
**리팩토링 전:**
```python
def classify_number(num):
    if num > 0:
        if num % 2 == 0:
            return "Positive Even"
        else:
            return "Positive Odd"
    else:
        return "Non-positive"
```

**리팩토링 후:**
```python
def classify_number(num):
    """Classify the number as positive even, positive odd, or non-positive."""
    if num <= 0:
        return "Non-positive"
    if num % 2 == 0:
        return "Positive Even"
    return "Positive Odd"
```

---

### 3. 클로저 금지
- 함수 내부에서 다른 함수를 정의하지 않습니다.
- 모든 헬퍼 함수는 **독립적인 전역 함수** 또는 **클래스 메서드**로 작성합니다.

#### ✅ 예시
**리팩토링 전:**
```python
def calculate_total(data):
    def is_valid(item):
        return item > 0
    return sum(item for item in data if is_valid(item))
```

**리팩토링 후:**
```python
def is_valid_item(item):
    """Check if the item is valid (greater than 0)."""
    return item > 0

def calculate_total(data):
    """Calculate the sum of valid items in the data."""
    return sum(item for item in data if is_valid_item(item))
```

---

### 4. 로직 분리 및 모듈화
- 코드가 길거나 복잡할 경우, 관련 기능을 **독립적인 함수/클래스**로 분리합니다.
- 동일한 작업을 반복적으로 수행하는 경우, 재사용 가능한 **헬퍼 함수**를 작성합니다.

#### ✅ 예시
**리팩토링 전:**
```python
def analyze_data(data):
    total = 0
    count = 0
    for item in data:
        if item > 0:
            total += item
            count += 1
    avg = total / count if count > 0 else 0
    return total, avg
```

**리팩토링 후:**
```python
def calculate_total_and_count(data):
    """Calculate the total and count of positive items."""
    total = sum(item for item in data if item > 0)
    count = sum(1 for item in data if item > 0)
    return total, count

def calculate_average(total, count):
    """Calculate the average given total and count."""
    return total / count if count > 0 else 0

def analyze_data(data):
    """Analyze the data and return total and average of positive items."""
    total, count = calculate_total_and_count(data)
    avg = calculate_average(total, count)
    return total, avg
```

---

### 5. 스타일 가이드 준수
- [PEP 8](https://peps.python.org/pep-0008/) 스타일 가이드를 준수합니다.
- 각 함수와 클래스에는 간결한 **docstring**을 추가합니다.

#### ✅ 예시
**리팩토링 전:**
```python
def process(data): return [x * 2 for x in data if x > 0]
```

**리팩토링 후:**
```python
def process_data(data):
    """Process the data by doubling positive numbers."""
    return [x * 2 for x in data if x > 0]
```

---

## 📋 **출력 형식**

1. **리팩토링 전 코드**
   - 원본 코드를 그대로 표시합니다.

2. **리팩토링 후 코드**
   - 모든 지침을 준수한 리팩토링된 코드를 제공합니다.

3. **위반 지침 목록**
   - 리팩토링된 코드에서 위반된 지침을 명시합니다.
   - 수정 방안을 설명합니다.

---

## 🎓 **입력 예시**
```python
def calculate(data):
    def is_positive(x):
        return x > 0
    return sum(x for x in data if is_positive(x))
```

---

## 🛠 **출력 예시**

### 리팩토링 전 코드
```python
def calculate(data):
    def is_positive(x):
        return x > 0
    return sum(x for x in data if is_positive(x))
```

### 리팩토링 후 코드
```python
def is_positive(x):
    """Check if a number is positive."""
    return x > 0

def calculate(data):
    """Calculate the sum of positive numbers."""
    return sum(x for x in data if is_positive(x))
```

### 위반 지침 목록
- 클로저 사용: 함수 내부에 `is_positive` 정의됨.

### 리팩토링 방안
- `is_positive`를 독립적인 함수로 분리하여 클로저 사용을 방지했습니다.

---

## 🚀 **적용된 논리**
1. **지침 위반 검출**: 코드에서 지침 위반 사항(예: 함수 길이 초과, 클로저 사용, 중첩 조건문)을 탐지합니다.
2. **자동화된 개선 방안 제시**: 위반된 지침에 대한 수정 방안을 설명하고 최적화된 코드를 제공합니다.
3. **지침 준수 확인**: 리팩토링 결과물이 모든 지침을 준수하는지 확인합니다.

